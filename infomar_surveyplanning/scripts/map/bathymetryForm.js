var depthForm = document.getElementById('form');
var startDepthInput = document.getElementById('from');
var endDepthInput = document.getElementById('to');
var colorScaleDrop = document.getElementById('colorscale');
var azimuthInput = document.getElementById('azimuth');
var altitudeInput = document.getElementById('altitude');
var zfactorInput = document.getElementById('zfactor');
var depthbyRangeRendering;
var newMaskRule;

$('#GreyColorScale').hide();
$('#BlueColorScale').hide();
$('#BlueBrownScale').hide();
$('#GreenScale').hide();
$('#BlueGreenScale').hide();
$('#OrangeGreenBlueScale').show();

depthForm.addEventListener('submit', function depthbyRangeClick(e) {
	var colorRamp = colorRamps(colorScaleDrop.value);
	var outValues = [];
    
    for (var i = 1; i < 101; i++) {
            outValues.push(
                i 
            );
        }
		
var inpRange = [];
var maxDepth = parseFloat(startDepthInput.value);
var minDepth = parseFloat(endDepthInput.value);
var interval = (maxDepth-minDepth)/100;

	if(maxDepth>minDepth){
		alert("The highest point must be greater then the lowest point.  Please use the minus sign to denote values below sea level.");
	}
	if(maxDepth>0){
		alert("Please use the minus sign to denote values below sea level.");
	}

inpRange.push(
 Math.round((maxDepth + 0.000001) * 1000)/1000
  );
for (var i = 1; i < 100; i++) {
    inpRange.push(
         Math.round(((maxDepth - (interval * i)) + 0.000001) * 1000)/1000,Math.round(((maxDepth - (interval * i)) + 0.000001) * 1000)/1000
     );
}
inpRange.push(
 Math.round((minDepth + 0.000001) * 1000)/1000
);


	depthbyRangeRendering = {
	"rasterFunction" : "Colormap",
	"rasterFunctionArguments" : {
    "Colormap" : colorRamp,
    "Raster":{
				"rasterFunction": "Remap",
				"rasterFunctionArguments": {
				"InputRanges": inpRange,
				"OutputValues": outValues,
                "Raster":{		
							"rasterFunction" : "Mask",
							"rasterFunctionArguments" : {
							"IncludedRanges" : [maxDepth,minDepth]
							},  
							"variableName" : "DEM"
							},
                  },
               "outputPixelType": "U8"
             },     
  },
  "outputPixelType": "U8"
};
	Bathy.setRenderingRule(depthbyRangeRendering);

if(azimuthInput.value<0){
	alert ("The Azimuth must be greater than 0");
}
if(azimuthInput.value>360){
	alert ("The Azimuth must be less than 360");
}	
if(altitudeInput.value<0){
	alert ("The Altitude must be greater than 0");
}
if(altitudeInput.value>90){
	alert ("The Altitude must be less than 90");
}
if(zfactorInput.value<0){
	alert ("The Z factor must be greater than 0");
}

  newMaskRule = {	
		 "rasterFunction" : "Hillshade",
		 "rasterFunctionArguments" : {
						 "Azimuth" : 315.0,
						 "Altitude" : 45.0,
						 "ZFactor" : 5*(3),
						 "DEM": {
							 "rasterFunction" : "Mask",
							 "rasterFunctionArguments" : {
							 "IncludedRanges" : [maxDepth,minDepth]
						 },  
						 "variableName" : "DEM"
						 },
					},
				  };					

			
	
	BathyShaded.setRenderingRule(newMaskRule);	
	BathyShaded.bringToBack();
	colorRampsLegend(colorScaleDrop.value);
	e.preventDefault();
	
  });
  
  function colorRamps(color) {
var inc1 = 2;
var inc2 = 2;
var inc3 = 2;

  switch (color){
	case "BlueBrown":
			var BlueBrown =[
[1,2,67,133],[2,5,71,138],[3,7,75,143],[4,10,79,148],[5,12,83,153],[6,15,86,158],[7,17,90,163],[8,20,94,168],[9,23,98,173],[10,25,102,178],[11,28,105,183],[12,30,109,188],[13,33,113,194],[14,35,117,199],[15,38,121,204],[16,40,124,209],[17,43,128,214],[18,46,132,219],[19,48,136,224],[20,51,140,229],[21,53,143,234],[22,56,147,239],[23,58,151,244],[24,61,155,249],[25,64,159,255],[26,67,159,251],[27,71,159,247],[28,75,159,243],[29,79,159,239],[30,83,159,235],[31,86,159,231],[32,90,159,228],[33,94,159,224],[34,98,159,220],[35,102,159,216],[36,105,159,212],[37,109,159,208],[38,113,159,205],[39,117,159,201],[40,121,159,197],[41,124,159,193],[42,128,159,189],[43,132,159,185],[44,136,159,182],[45,140,159,178],[46,143,159,174],[47,147,159,170],[48,151,159,166],[49,155,159,162],[50,159,159,159],[51,162,160,157],[52,166,161,156],[53,170,162,155],[54,174,164,154],[55,178,165,152],[56,182,166,151],[57,185,167,150],[58,189,169,149],[59,193,170,147],[60,197,171,146],[61,201,173,145],[62,205,174,144],[63,208,175,142],[64,212,176,141],[65,216,178,140],[66,220,179,139],[67,224,180,137],[68,228,182,136],[69,231,183,135],[70,235,184,134],[71,239,185,132],[72,243,187,131],[73,247,188,130],[74,251,189,129],[75,255,191,128],[76,249,185,122],[77,244,180,117],[78,239,175,112],[79,234,170,107],[80,229,165,102],[81,224,160,97],[82,219,155,92],[83,214,150,87],[84,209,145,81],[85,204,140,76],[86,199,135,71],[87,194,130,66],[88,188,124,61],[89,183,119,56],[90,178,114,51],[91,173,109,46],[92,168,104,40],[93,163,99,35],[94,158,94,30],[95,153,89,25],[96,148,84,20],[97,143,79,15],[98,138,74,10],[99,133,69,5],[100,128,64,0],
];
return BlueBrown;
	break;

case "Grey":
 var Grey1 = [	
[100,234, 238, 241],[99,232,236,239],[98,230,234,237],[97,228,232,235],[96,226,230,233],[95,224,228,231],[94,222,226,229],[93,220,224,227],[92,219,222,225],[91,217,220,223],[90,215,219,221],[89,213,217,219],[88,211,215,217],[87,209,213,215],[86,207,211,213],[85,206,209,212],[84,204,207,210],[83,202,205,208],[82,200,203,206],[81,198,201,204],[80,196,200,202],[79,194,198,200],[78,193,196,198],[77,191,194,196],[76,189,192,194],[75,187,190,192],[74,185,188,190],[73,183,186,188],[72,181,184,186],[71,180,182,185],[70,178,181,183],[69,176,179,181],[68,174,177,179],[67,172,175,177],[66,170,173,175],[65,168,171,173],[64,167,169,171],[63,165,167,169],[62,163,165,167],[61,161,163,165],[60,159,162,163],[59,157,160,161],[58,155,158,159],[57,154,156,158],[56,152,154,156],[55,150,152,154],[54,148,150,152],[53,146,148,150],[52,144,146,148],[51,142,144,146],[50,141,143,144],[49,139,141,142],[48,137,139,140],[47,135,137,138],[46,133,135,136],[45,131,133,134],[44,129,131,132],[43,128,129,131],[42,126,127,129],[41,124,125,127],[40,122,124,125],[39,120,122,123],[38,118,120,121],[37,116,118,119],[36,115,116,117],[35,113,114,115],[34,111,112,113],[33,109,110,111],[32,107,108,109],[31,105,106,107],[30,103,105,105],[29,102,103,104],[28,100,101,102],[27,98,99,100],[26,96,97,98],[25,94,95,96],[24,92,93,94],[23,90,91,92],[22,89,89,90],[21,87,87,88],[20,85,86,86],[19,83,84,84],[18,81,82,82],[17,79,80,80],[16,77,78,78],[15,76,76,77],[14,74,74,75],[13,72,72,73],[12,70,70,71],[11,68,68,69],[10,66,67,67],[9,64,65,65],[8,63,63,63],[7,61,61,61],[6,59,59,59],[5,57,57,57],[4,55,55,55],[3,53,53,53],[2,51,51,51],[1,50,50,50],
];
return Grey1;
	break;		 

case "Blue":	
 var Blue = [
[100,198,219,239],[99,195,218,238],[98,193,217,237],[97,191,216,236],[96,189,215,235],[95,186,214,235],[94,184,213,234],[93,182,212,233],[92,180,211,232],[91,178,210,232],[90,175,209,231],[89,173,208,230],[88,171,207,229],[87,169,206,228],[86,166,205,228],[85,164,204,227],[84,162,203,226],[83,160,202,225],[82,158,202,225],[81,155,200,224],[80,152,198,223],[79,149,197,223],[78,146,195,222],[77,143,194,221],[76,141,192,221],[75,138,191,220],[74,135,189,220],[73,132,188,219],[72,129,186,218],[71,126,184,218],[70,124,183,217],[69,121,181,217],[68,118,180,216],[67,115,178,215],[66,112,177,215],[65,109,175,214],[64,107,174,214],[63,104,172,213],[62,102,170,212],[61,100,169,211],[60,97,167,210],[59,95,166,209],[58,93,164,208],[57,91,163,207],[56,88,161,206],[55,86,160,206],[54,84,158,205],[53,81,156,204],[52,79,155,203],[51,77,153,202],[50,75,152,201],[49,72,150,200],[48,70,149,199],[47,68,147,198],[46,66,146,198],[45,64,144,197],[44,62,142,196],[43,60,140,195],[42,58,138,194],[41,56,136,193],[40,55,135,192],[39,53,133,191],[38,51,131,190],[37,49,129,189],[36,47,127,188],[35,45,125,187],[34,44,124,186],[33,42,122,185],[32,40,120,184],[31,38,118,183],[30,36,116,182],[29,34,114,181],[28,33,113,181],[27,31,111,179],[26,30,109,178],[25,28,107,176],[24,27,105,175],[23,26,104,174],[22,24,102,172],[21,23,100,171],[20,21,98,169],[19,20,97,168],[18,19,95,167],[17,17,93,165],[16,16,91,164],[15,14,89,162],[14,13,88,161],[13,12,86,160],[12,10,84,158],[11,9,82,157],[10,8,81,156],[9,8,79,153],[8,8,77,150],[7,8,75,147],[6,8,73,145],[5,8,71,142],[4,8,70,139],[3,8,68,136],[2,8,66,134],[1,8,64,131],
];
 
return Blue;
	break;	

case "Green":	
var Green = [
[100,204,236,230],[99,201,234,228],[98,198,233,226],[97,195,232,225],[96,192,231,223],[95,189,230,221],[94,187,229,220],[93,184,228,218],[92,181,227,217],[91,178,226,215],[90,175,224,213],[89,172,223,212],[88,170,222,210],[87,167,221,209],[86,164,220,207],[85,161,219,205],[84,158,218,204],[83,155,217,202],[82,153,216,201],[81,150,214,198],[80,147,213,196],[79,144,212,194],[78,141,211,192],[77,138,209,190],[76,136,208,188],[75,133,207,186],[74,130,206,184],[73,127,205,182],[72,124,203,180],[71,121,202,178],[70,119,201,176],[69,116,200,174],[68,113,198,172],[67,110,197,170],[66,107,196,168],[65,104,195,166],[64,102,194,164],[63,99,192,161],[62,97,191,158],[61,95,190,156],[60,93,189,153],[59,91,188,151],[58,89,187,148],[57,87,186,146],[56,85,185,143],[55,83,184,141],[54,81,182,138],[53,79,181,135],[52,77,180,133],[51,75,179,130],[50,73,178,128],[49,71,177,125],[48,69,176,123],[47,67,175,120],[46,65,174,118],[45,63,172,115],[44,61,170,112],[43,60,168,109],[42,58,166,107],[41,56,164,104],[40,55,162,101],[39,53,160,98],[38,51,158,96],[37,50,156,93],[36,48,154,90],[35,46,152,88],[34,45,150,85],[33,43,148,82],[32,41,146,79],[31,40,144,77],[30,38,142,74],[29,36,140,71],[28,35,139,69],[27,33,137,67],[26,31,135,66],[25,29,134,64],[24,27,132,63],[23,25,130,62],[22,23,129,60],[21,21,127,59],[20,19,125,57],[19,17,124,56],[18,15,122,55],[17,13,120,53],[16,11,119,52],[15,9,117,50],[14,7,115,49],[13,5,114,48],[12,3,112,46],[11,1,110,45],[10,0,109,44],[9,0,106,43],[8,0,104,42],[7,0,102,41],[6,0,100,40],[5,0,98,39],[4,0,96,38],[3,0,93,37],[2,0,91,36],[1,0,89,35],
];
return Green;
	break;	

case"BlueGreen":	
var BlueGreen = [
[100,163,219,182],[99,160,218,183],[98,158,217,184],[97,156,216,184],[96,153,215,185],[95,151,214,186],[94,149,213,187],[93,146,212,188],[92,144,212,188],[91,141,211,189],[90,139,210,190],[89,137,209,191],[88,134,208,192],[87,132,207,192],[86,130,206,193],[85,127,205,194],[84,125,204,195],[83,123,204,196],[82,120,202,196],[81,118,201,197],[80,115,200,198],[79,113,198,199],[78,111,197,199],[77,108,196,200],[76,106,194,201],[75,104,193,202],[74,101,192,203],[73,99,190,203],[72,96,189,204],[71,94,188,205],[70,92,186,206],[69,89,185,207],[68,87,184,207],[67,85,182,208],[66,82,181,209],[65,80,180,210],[64,78,179,211],[63,76,177,210],[62,74,175,209],[61,73,173,208],[60,71,171,207],[59,69,169,206],[58,68,167,205],[57,66,166,204],[56,64,164,203],[55,63,162,202],[54,61,160,201],[53,59,158,200],[52,58,156,199],[51,56,154,198],[50,54,153,197],[49,53,151,196],[48,51,149,195],[47,49,147,194],[46,48,145,193],[45,46,143,192],[44,44,141,191],[43,43,140,190],[42,41,138,189],[41,39,136,188],[40,38,134,187],[39,36,133,186],[38,34,131,185],[37,33,129,184],[36,31,128,184],[35,29,126,183],[34,28,124,182],[33,26,122,181],[32,24,121,180],[31,23,119,179],[30,21,117,178],[29,19,116,178],[28,18,114,177],[27,16,112,176],[26,14,110,175],[25,13,109,174],[24,11,107,173],[23,9,105,172],[22,8,104,172],[21,8,102,169],[20,8,100,167],[19,8,98,165],[18,8,96,163],[17,8,94,161],[16,8,92,159],[15,8,90,157],[14,8,88,155],[13,8,86,153],[12,8,84,151],[11,8,83,149],[10,8,81,147],[9,8,79,145],[8,8,77,143],[7,8,75,141],[6,8,73,139],[5,8,71,137],[4,8,69,135],[3,8,67,133],[2,8,65,131],[1,8,64,129],
];
return BlueGreen;
	break;	
	
case"OrangeGreenBlue":	
var OrangeGreenBlue = [	  
[100,253,107,0],[99,252,111,0],[98,252,115,0],[97,252,120,0],[96,251,124,0],[95,251,129,0],[94,251,133,0],[93,250,137,0],[92,250,142,0],[91,250,146,0],[90,249,151,0],[89,249,155,0],[88,249,159,0],[87,248,164,0],[86,248,168,0],[85,248,173,0],[84,247,177,0],[83,247,181,0],[82,247,186,0],[81,246,190,0],[80,246,195,0],[79,246,199,0],[78,245,203,0],[77,245,208,0],[76,245,212,0],[75,245,217,1],[74,235,218,5],[73,226,219,10],[72,217,220,15],[71,208,221,19],[70,199,222,24],[69,190,223,29],[68,181,224,33],[67,172,225,38],[66,163,226,43],[65,154,227,47],[64,145,228,52],[63,136,229,57],[62,126,231,61],[61,117,232,66],[60,108,233,71],[59,99,234,75],[58,90,235,80],[57,81,236,85],[56,72,237,89],[55,63,238,94],[54,54,239,99],[53,45,240,103],[52,36,241,108],[51,27,242,113],[50,18,244,118],[49,17,234,123],[48,16,224,128],[47,15,214,134],[46,15,204,139],[45,14,195,145],[44,13,185,150],[43,12,175,156],[42,12,165,161],[41,11,156,167],[40,10,146,172],[39,10,136,178],[38,9,126,183],[37,8,117,189],[36,7,107,194],[35,7,97,200],[34,6,87,205],[33,5,78,211],[32,5,68,216],[31,4,58,222],[30,3,48,227],[29,2,39,233],[28,2,29,238],[27,1,19,244],[26,0,9,249],[25,0,0,255],[24,3,0,250],[23,7,1,245],[22,11,2,240],[21,15,3,235],[20,19,4,230],[19,22,5,225],[18,26,5,220],[17,30,6,215],[16,34,7,210],[15,38,8,205],[14,41,9,200],[13,45,10,195],[12,49,11,190],[11,53,11,185],[10,57,12,180],[9,60,13,175],[8,64,14,170],[7,68,15,165],[6,72,16,160],[5,76,16,155],[4,79,17,150],[3,83,18,145],[2,87,19,140],[1,91,20,135],
	];
return OrangeGreenBlue;
	break;	
 	  }
};

function colorRampsLegend(color) {

  switch (color){
	case "Blue":
	$('#BlueColorScale').show();
	$('#GreyColorScale').hide();
	$('#BlueBrownScale').hide();
	$('#GreenScale').hide();
	$('#BlueGreenScale').hide();
	$('#OrangeGreenBlueScale').hide();
break;
  }
  switch (color){
	case "Grey":
	$('#BlueColorScale').hide();
	$('#GreyColorScale').show();
	$('#BlueBrownScale').hide();
	$('#GreenScale').hide();
	$('#BlueGreenScale').hide();
	$('#OrangeGreenBlueScale').hide();
  }
    switch (color){
	case "BlueGreen":
	$('#BlueColorScale').hide();
	$('#GreyColorScale').hide();
	$('#BlueBrownScale').hide();
	$('#GreenScale').hide();
	$('#BlueGreenScale').show();
	$('#OrangeGreenBlueScale').hide();
  }
    switch (color){
	case "BlueBrown":
	$('#BlueColorScale').hide();
	$('#GreyColorScale').hide();
	$('#BlueBrownScale').show();
	$('#GreenScale').hide();
	$('#BlueGreenScale').hide();
	$('#OrangeGreenBlueScale').hide();
  }
     switch (color){
	case "Green":
	$('#BlueColorScale').hide();
	$('#GreyColorScale').hide();
	$('#BlueBrownScale').hide();
	$('#GreenScale').show();
	$('#BlueGreenScale').hide();
	$('#OrangeGreenBlueScale').hide();
  }
     switch (color){
	case "OrangeGreenBlue":
	$('#BlueColorScale').hide();
	$('#GreyColorScale').hide();
	$('#BlueBrownScale').hide();
	$('#GreenScale').hide();
	$('#BlueGreenScale').hide();
	$('#OrangeGreenBlueScale').show();
  }
  $('#colorLeg').attr("src","images/"+colorScaleDrop.value+".png");
};
